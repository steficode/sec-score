{
  "ruleList": [
    {
      "id" : 1,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']/config/items[name/text()='hadoop_security_authentication']/value='kerberos'",
      "level": 1,
      "description": "HDFS Kerberos",
      "service" : "HDFS",
      "fatal": true,
      "passMessage" : "HDFS Kerberos is configured",
      "errorMessage": "Cluster's HDFS is not secured.  Any host with network access to the cluster can compromise all data within the cluster.  Including access, manipulation and deletion.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_intro_kerb.html",
      "score": 100,
      "categories" : ["Authentication"]
    },
    {
      "id" : 2,
      "ruleXPath": "/Security/deployment/ObjectNode/managerSettings/items[name='AGENT_TLS']/value[text()='true']",
      "level": 2,
      "description": "Agent TLS",
      "service" : "Cloudera Manager",
      "fatal": true,
      "passMessage" : "Agent TLS is configured",
      "errorMessage": "Agent TLS is not configured.  Transport Layer Security encrypts the communication between Cloudera Manager and the Cloudera Manager Agents.  Sensitive login information is transferred to nodes and should be encrypted.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_config_tls_auth.html",
      "score": 50,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 3,
      "ruleXPath": "/Security/deployment/ObjectNode/managerSettings/items[name='NEED_AGENT_VALIDATION']/value[text()='true']",
      "level": 2,
      "description": "Agent TLS with authentication",
      "service" : "Cloudera Manager",
      "fatal": true,
      "passMessage" : "TLS Authentication of Agents to Server is configured",
      "errorMessage": "TLS Authentication of Agents to Server is not configured.  This configuration of Transport Layer Security prevents rogue hosts from being added to the cluster.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_config_tls_agent_auth.html",
      "score": 3,
      "categories" : ["Authentication"]
    },
    {
      "id" : 4,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']//items[name='ssl_enable']/value='true'",
      "level": 2,
      "description": "Hue TLS",
      "service" : "Hue",
      "fatal": false,
      "passMessage" : "Hue is configured to use TLS",
      "errorMessage": "Hue is not configured for TLS (HTTPS).  Login credentials can be observed on the network in addition to data returned as results from queries.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_ssl_hue.html",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 5,
      "preConditionXPath": "/Security/sec-inspector/ObjectNode",
      "ruleXPath": "/Security/sec-inspector/ObjectNode/failedHostsWithError/*",
      "level": 1,
      "description": "Security Inspector Failures",
      "service" : "Cloudera Manager",
      "fatal": false,
      "failOnTrue": true,
      "passMessage" : "All hosts passed the host inspector",
      "errorMessage" : "One or more hosts failed the host inspector.",
      "score": 2,
      "categories" : ["miscellaneous"]
    },
    {
      "id" : 7,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']//config/items[name='disk_spill_encryption']/value='true'",
      "level": 2,
      "description": "Impala disk spill encryption",
      "service" : "Impala",
      "fatal": false,
      "passMessage" : "Impala is configured with disk spill encryption.",
      "errorMessage": "Impala is not configured for disk spill encryption.  Temporary data for Impala queries that does not fit in memory will be written unencrypted to disk.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_spill_encryption.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Ephemeral on-disk encryption"]
    },
    {
      "id" : 8,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']//config/items[name='kms_service'][value=/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE']/name]",
      "level": 2,
      "description": "HDFS KMS",
      "service" : "HDFS",
      "fatal": false,
      "passMessage" : "HDFS KMS is configured.",
      "errorMessage": "HDFS KMS is not configured.  The HDFS Key Management Service provides a scalable and robust key management platform, and is required for providing encryption at rest in HDFS.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/navigator_encryption.html",
      "failOnTrue": "false",
      "score": 40,
      "categories" : ["Encryption at rest"]
    },
    {
      "id" : 9,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SOLR']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SOLR']//config/items[name='sentry_service'][value=/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SENTRY']/name]",
      "level": 1,
      "description": "Solr configured for Sentry Service",
      "service" : "Solr",
      "fatal": false,
      "passMessage" : "Solr is using the Sentry Service.",
      "errorMessage": "Solr is not configured to use the Sentry Service.  Sentry provides centralized authorization to access data stored in CDH",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/search_sentry.html",
      "failOnTrue": "false",
      "score": 10,
      "categories" : ["Authorization"]
    },
    {
      "id" : 10,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KAFKA']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KAFKA']//config/items[name='sentry_service'][value=/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SENTRY']/name]",
      "level": 1,
      "description": "Kafka configured for Sentry Service",
      "service" : "Kafka",
      "fatal": false,
      "passMessage" : "Kafka is using the Sentry Service.",
      "errorMessage": "Kafka is not configured to use the Sentry Service.  Sentry provides centralized authorization to access data stored in CDH",
      "documentation": "https://www.cloudera.com/documentation/kafka/latest/topics/kafka_security.html#using_kafka_with_sentry",
      "failOnTrue": "false",
      "score": 10,
      "categories" : ["Authorization"]
    },
    {
      "id" : 11,
      "ruleXPath": "/Security/deployment/ObjectNode/managementService[type='MGMT']/roles[type='NAVIGATOR'] and /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "level": 2,
      "description": "Cloudera Navigator",
      "service" : "Cloudera Navigator",
      "fatal": false,
      "passMessage" : "Cloudera Navigator is installed.",
      "errorMessage": "Cloudera Navigator is not installed.  Cloudera Navigator audits access to data, as well as tracking lineage of data.",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/navigator_data_mgmt.html",
      "failOnTrue": "false",
      "score": 40,
      "categories" : ["Audit", "Lineage"]
    },
    {
      "id" : 12,
      "ruleXPath": "/Security/deployment/ObjectNode/managerSettings/items[name='LDAP_URL']/value[starts-with(text(), 'ldaps:')]",
      "level": 2,
      "description": "Cloudera Manager configured to use LDAPS rather than LDAP",
      "service" : "Cloudera Manager",
      "fatal": false,
      "passMessage" : "CM uses LDAPS rather than LDAP.",
      "errorMessage": "Cloudera Manager is configured to use LDAP rather than LDAPS.  Login credentials can be observed on the network between Cloudera Manager and the LDAP server.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_external_auth.html#cmug_topic_13_9_2__section_ur1_wxn_mk",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Wire encryption", "Authorization"]
    },
    {
      "id" : 13,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']/config/items[name/text()='hadoop_security_authentication']/value='kerberos' or /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KAFKA']//items[name='kerberos.auth.enable']/value='true' or /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']//items[name='hbase_security_authentication']/value='kerberos' or /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SOLR']//config/items[name='solr_security_authentication']/value='kerberos'",
      "ruleXPath": "/Security/deployment/ObjectNode/managerSettings/items[name='KRB_ENC_TYPES']/value[contains(text(), 'rmac') or contains(text(), 'des')]",
      "level": 1,
      "description": "Kerberos encryption types",
      "service" : "General",
      "fatal": false,
      "passMessage" : "Strong encryption types used for Kerberos.",
      "errorMessage": "Weak encryption types used for Kerberos {0}.  Weak encryption types can be broken by modern computers and will provide less security than other encryption types.",
      "failOnTrue": "true",
      "score": 5,
      "categories" : ["Authentication"]
    },
    {
      "id" : 14,
      "ruleXPath": "/Security/deployment/ObjectNode/managerSettings/items[name='WEB_TLS']/value='true'",
      "level": 2,
      "description": "CM web TLS",
      "service" : "Cloudera Manager",
      "fatal": false,
      "passMessage" : "Cloudera Manager admin console protected through TLS",
      "errorMessage": "Cloudera Manager is not configured to apply TLS for the admin console.  Login credentials and data can be observed on the network between a web browser and Cloudera Manager.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/how_to_configure_cm_tls.html#xd_583c10bfdbd326ba-7dae4aa6-147c30d0933--7a61",
      "failOnTrue": "false",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 15,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SOLR']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SOLR']//config/items[name='navigator_audit_enabled']/value='true'",
      "level": 3,
      "description": "Solr Navigator audit event collection",
      "service" : "Solr",
      "fatal": false,
      "passMessage" : "Solr Navigator audit event collection is enabled.",
      "errorMessage": "Solr Navigator audit event collection is disabled.",
      "documentation" :"https://www.cloudera.com/documentation/enterprise/latest/topics/cn_iu_service_audit.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Audit"]
    },
    {
      "id" : 16,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='YARN']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='YARN']//items[name='yarn_acl_enable']/value[text()='false']",
      "level": 1,
      "description": "YARN Admin ACLs enabled",
      "service" : "YARN",
      "fatal": false,
      "passMessage" : "YARN Admin ACLs are enabled.",
      "errorMessage": "YARN Admin ACLs are disabled.  Any user can cancel or affect YARN jobs submitted by other users.",
      "documentation": "https://community.cloudera.com/t5/tkb/articleprintpage/tkb-id/JavaAPI%40tkb/article-id/2",
      "failOnTrue": "true",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 17,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE']//config/items[name='hadoop_kms_authentication_type']/value='kerberos'",
      "level": 2,
      "description": "KMS Kerberos authentication",
      "service" : "KMS",
      "fatal": true,
      "passMessage" : "KMS Kerberos authentication is enabled.",
      "errorMessage": "KMS Kerberos authentication is disabled.  This allows insecure authentication to the KMS",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_kms_security.html#concept_itb_f2v_mp",
      "failOnTrue": "false",
      "score": 10,
      "categories" : ["Authentication", "Encryption at rest"]
    },
    {
      "id" : 18,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']//config/items[name='dfs_encrypt_data_transfer']/value='true'",
      "level": 2,
      "description": "HDFS encrypted data transport",
      "service" : "HDFS",
      "fatal": false,
      "passMessage" : "HDFS encrypted data transport is enabled.",
      "errorMessage": "HDFS encrypted data transport is disabled.  Data transferred between HDFS Datanodes will be observable on the network.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_hdfs_encrypt_transport.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 19,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']//config/items[name='hadoop_rpc_protection']/value='privacy'",
      "level": 2,
      "description": "Hadoop RPC Protection",
      "service" : "HDFS",
      "fatal": false,
      "passMessage" : "Hadoop RPC Protection is enabled.",
      "errorMessage": "Hadoop RPC Protection is disabled.  HDFS issues commands between different roles through Remote Procedure Calls.  This configuration works with HDFS encrypted data transport to protect data transferred between Datanode roles.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_hdfs_encrypt_transport.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 20,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']//config/items[name='dfs_namenode_acls_enabled']/value='true'",
      "level": 1,
      "description": "HDFS Extended ACLs",
      "service" : "HDFS",
      "fatal": false,
      "passMessage" : "HDFS Extended ACLs enabled.",
      "errorMessage": "HDFS Extended ACLs disabled. Access Control Lists allow for fine grained control access control of files within HDFS.  In addition, the feature is required for HDFS Sentry Sync to function correctly.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_hdfs_ext_acls.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 21,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']//config/items[name='hdfs_sentry_sync_enable']/value='true'",
      "level": 1,
      "description": "HDFS Sentry Sync",
      "service" : "HDFS",
      "fatal": false,
      "passMessage" : "HDFS Sentry Sync enabled.",
      "errorMessage": "HDFS Sentry Sync is disabled.  Enabling this feature ensures that access controls defined in Sentry are enforced similarly through HDFS access.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_hdfs_sentry_sync.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 22,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services//config/items[name='dfs_datanode_port']/value[text()<1024]",
      "level": 1,
      "description": "HDFS DataNode transceiver port is above 1024",
      "service" : "HDFS",
      "fatal": false,
      "passMessage" : "HDFS DataNode transceiver port is above 1024.",
      "errorMessage": "HDFS DataNode transceiver port is below 1024.  Ports less than 1024 require root authority to connect, preventing spoofing",
      "failOnTrue": "true",
      "score": 1,
      "categories" : ["Authentication"]
    },
    {
      "id" : 23,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services//config/items[name='dfs_datanode_port']/value[text()<1024]",
      "level": 1,
      "description": "HDFS DataNode HTTP web UI port is above 1024",
      "service" : "HDFS",
      "fatal": false,
      "passMessage" : "HDFS DataNode HTTP web UI port is above 1024.",
      "errorMessage": "HDFS DataNode HTTP web UI port is below 1024.  Ports less than 1024 require root authority to connect, preventing spoofing",
      "failOnTrue": "true",
      "score": 1,
      "categories" : ["Authentication"]
    },
    {
      "id" : 24,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']/roles/type='HTTPFS'",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']//config/items[name='httpfs_use_ssl']/value='true'",
      "level": 2,
      "description": "HDFS HTTPFS TLS",
      "service" : "HDFS",
      "fatal": false,
      "passMessage" : "HDFS HTTPFS TLS enabled.",
      "errorMessage": "HDFS HTTPFS TLS disabled.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_httpfs_ssl.html",
      "failOnTrue": "false",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 25,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']//config/items[name='dfs_permissions_supergroup'][value!='supergroup']/value",
      "level": 1,
      "description": "HDFS Supergroup configuration",
      "service" : "HDFS",
      "fatal": false,
      "passMessage" : "HDFS Supergroup configuration has been configured away from the default: {0}",
      "errorMessage": "HDFS Supergroup configuration has not been configured away from the default (supergroup).  Default settings provide more information to a possible attacker",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 26,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']/config/items[name/text()='hdfs_hadoop_ssl_enabled']/value='true'",
      "level": 2,
      "description": "HDFS TLS for Web Consoles and Encrypted Shuffle",
      "service" : "HDFS",
      "fatal": false,
      "passMessage" : "HDFS has TLS turned on for web consoles and encrypted shuffle",
      "errorMessage": "HDFS does not have TLS turned on for web consoles or encrypted shuffle",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_ssl_yarn_mr_hdfs.html",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 27,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']/config/items[name/text()='hbase_hadoop_ssl_enabled']/value='true'",
      "level": 2,
      "description": "HBase TLS for Web Consoles",
      "service" : "HBase",
      "fatal": false,
      "passMessage" : "HBase has TLS turned on for web consoles",
      "errorMessage": "HBase does not have TLS turned on for web consoles",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_ssl_hbase.html",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 28,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']/roleConfigGroups[roleType='HBASERESTSERVER']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']/roleConfigGroups[roleType='HBASERESTSERVER']/config/items[name/text()='hbase_restserver_ssl_enable']/value='true'",
      "level": 2,
      "description": "HBase TLS for the Rest Server",
      "service" : "HBase",
      "fatal": false,
      "passMessage" : "HBase has TLS turned on for the Rest Server",
      "errorMessage": "HBase does not have TLS turned on for the Rest Server",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_ssl_hbase.html",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 29,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']/roles[type='HBASERESTSERVER']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']//items[name='hbase_restserver_security_authentication']/value='kerberos'",
      "level": 1,
      "description": "HBase Authentication for the Rest Server",
      "service" : "HBase",
      "fatal": false,
      "passMessage" : "HBase has authentication turned on for the Rest Server",
      "errorMessage": "HBase does not have authentication turned on for the Rest Server",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_ssl_hbase.html",
      "score": 2,
      "categories" : ["Authentication"]
    },
    {
      "id" : 30,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']/roleConfigGroups[roleType='HBASETHRIFTSERVER']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']/roleConfigGroups[roleType='HBASETHRIFTSERVER']/config/items[name/text()='hbase_thriftserver_http_use_ssl']/value='true'",
      "level": 2,
      "description": "HBase TLS for the Thrift Server",
      "service" : "HBase",
      "fatal": false,
      "passMessage" : "HBase has TLS turned on for the Thrift Server",
      "errorMessage": "HBase does not have TLS turned on for the Thrift Server",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_ssl_hbase.html",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 31,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']/roles[type='HBASETHRIFTSERVER']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']//items[name='hbase_thriftserver_security_authentication']/starts-with(value,'auth')",
      "level": 1,
      "description": "HBase Authentication for the Thrift Server",
      "service" : "HBase",
      "fatal": false,
      "passMessage" : "HBase has authentication turned on for the Thrift Server",
      "errorMessage": "HBase does not have authentication turned on for the Thrift Server",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_hbase_authentication.html#concept_xrw_ybw_4t",
      "score": 2,
      "categories" : ["Authentication"]
    },
    {
      "id" : 32,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']/roles/type='NFSGATEWAY'",
      "level": 1,
      "description": "HDFS NFS Gateway",
      "service" : "HDFS",
      "fatal": false,
      "passMessage" : "HDFS NFS Gateway is not enabled.",
      "errorMessage": "HDFS NFS Gateway relies on local user ids on a client as well as the NFSv3 protocol.  This is a security risk and should be disabled.",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/admin_hdfs_nfsgateway.html",
      "failOnTrue": "true",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 33,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']//config/items[name='navigator_audit_enabled']/value='false' or not(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']//config/items[name='enable_audit_event_log']/value='true')",
      "level": 3,
      "description": "Impala audit event collection",
      "service" : "Impala",
      "fatal": false,
      "passMessage" : "Impala audit event collection is enabled.",
      "errorMessage": "Impala audit event collection is disabled.",
      "documentation" :"https://www.cloudera.com/documentation/enterprise/latest/topics/cn_iu_service_audit.html",
      "failOnTrue": "true",
      "score": 1,
      "categories" : ["Audit", "Lineage"]
    },
    {
      "id" : 34,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SENTRY']",
      "ruleXPath": "let $exceptions := ((/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE']/config/items[name='kerberos_princ_name']/value/string(),'hive')[1],(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']/config/items[name='kerberos_princ_name']/value/string(),'hue')[1],(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']/config/items[name='kerberos_princ_name']/value/string(),'impala')[1],(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SOLR']/config/items[name='kerberos_princ_name']/value/string(),'solr')[1],(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KAFKA']/config/items[name='kerberos_princ_name']/value/string(),'kafka')[1],(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='RECORDSERVICE']/config/items[name='kerberos_princ_name']/value/string(),'recordservice')[1]) return string-join(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SENTRY']//items[name='sentry_service_admin_group']/tokenize(value,',')[not(. = $exceptions)],',')",
      "level": 1,
      "description": "Sentry admin groups",
      "service" : "Sentry",
      "fatal": false,
      "passMessage" : "A Sentry admin group has been defined: {0}",
      "errorMessage": "No Sentry admin group has been defined.  Without an admin group, Sentry roles cannot be properly created",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_sentry_service_config.html#concept_z5b_42s_p4__section_vrc_1dk_55",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 35,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE']//items[name='sentry_service'][value=/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SENTRY']/name]",
      "level": 1,
      "description": "Hive Sentry Plugin",
      "service" : "Hive",
      "fatal": false,
      "passMessage" : "Hive is configured to use the Sentry Service.",
      "errorMessage": "Hive is not configured to use the Sentry Service.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_sentry_service_config.html#concept_z5b_42s_p4__section_n4d_4g4_rp",
      "failOnTrue": "false",
      "score": 2,
      "categories" : ["Authorization"]
    },
    {
      "id" : 36,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE']//items[name='sentry_service'][value=/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SENTRY']/name]",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE']//items[name='hiveserver2_enable_impersonation']/value='false'",
      "level": 1,
      "description": "Hive Impersonation Disabled",
      "service" : "Hive",
      "fatal": false,
      "passMessage" : "Hive impersonation is disabled.",
      "errorMessage": "Hive impersonation should be disabled when using Sentry.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_sentry_service_config.html",
      "failOnTrue": "false",
      "score": 2,
      "categories" : ["Authorization"]
    },
    {
      "id" : 37,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']//items[name='sentry_service'][value=/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SENTRY']/name]",
      "level": 1,
      "description": "Impala Sentry Plugin",
      "service" : "Impala",
      "fatal": false,
      "passMessage" : "Impala is configured to use the Sentry Service.",
      "errorMessage": "Impala is not configured to use the Sentry Service.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_sentry_service_config.html#concept_z5b_42s_p4__sentryserref",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 38,
      "ruleXPath": "/Security/deployment/ObjectNode/managerSettings/items[name='AUTH_BACKEND_ORDER']/value[text()='LDAP_ONLY' or text()='EXTERNAL_ONLY_WITHOUT_DB_ADMINS']",
      "level": 1,
      "description": "Cloudera Manager configured to authenticate against LDAP",
      "service" : "Cloudera Manager",
      "fatal": false,
      "failOnTrue": false,
      "passMessage": "Cloudera Manager is configured to authenticate exclusively against LDAP.",
      "errorMessage": "Cloudera Manager should be configured to authenticate exclusively against LDAP.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_external_auth.html",
      "score": 5,
      "categories" : ["Authentication"]
    },
    {
      "id" : 40,
      "preConditionXPath": "/Security/deployment/ObjectNode/managementService/roleConfigGroups[roleType='NAVIGATORMETASERVER'] and /Security/deployment/ObjectNode/managementService[type='MGMT']/roles[type='NAVIGATOR'] and /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/managementService/roleConfigGroups[roleType='NAVIGATORMETASERVER']//items[name='auth_backend_order']/value[text()='EXTERNAL_ONLY']",
      "level": 1,
      "description": "Cloudera Navigator configured to authenticate against an external source",
      "service" : "Cloudera Navigator",
      "fatal": false,
      "failOnTrue": false,
      "passMessage": "Cloudera Navigator is configured to authenticate exclusively against an external source.",
      "errorMessage": "Cloudera Navigator should be configured to authenticate exclusively against an external source.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cn_sg_external_auth.html",
      "score": 2,
      "categories" : ["Authentication"]
    },
    {
      "id" : 41,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SOLR']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SOLR']//config/items[name='solr_security_authentication']/value='kerberos'",
      "level": 1,
      "description": "Solr Kerberos",
      "service" : "Solr",
      "fatal": false,
      "passMessage" : "Solr is configured for Kerberos authentication.",
      "errorMessage": "Solr does not have authentication enabled.",
      "documentation" :"https://www.cloudera.com/documentation/enterprise/latest/topics/search_using_kerberos.html",
      "failOnTrue": "false",
      "score": 5,
      "categories" : ["Authentication"]
    },
    {
      "id" : 42,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SOLR'] and /Security/deployment/ObjectNode/managementService[type='MGMT']/roles[type='NAVIGATOR']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SOLR']//config/items[name='navigator_audit_queue_policy']/value='SHUTDOWN'",
      "level": 3,
      "description": "Solr Audit Drop policy",
      "service" : "Solr",
      "fatal": false,
      "passMessage" : "Solr Audit Drop policy is set to shutdown.",
      "errorMessage": "Solr Audit Drop policy is not to shutdown - in the event of a failure audit events may be dropped.",
      "documentation" :"https://www.cloudera.com/documentation/enterprise/latest/topics/cn_iu_service_audit.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Audit"]
    },
    {
      "id" : 43,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS'] and /Security/deployment/ObjectNode/managementService[type='MGMT']/roles[type='NAVIGATOR']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']//config/items[name='navigator_audit_queue_policy']/value='SHUTDOWN'",
      "level": 3,
      "description": "HDFS Audit Drop policy",
      "service" : "HDFS",
      "fatal": false,
      "passMessage" : "HDFS Audit Drop policy is set to shutdown.",
      "errorMessage": "HDFS Audit Drop policy is not to shutdown - in the event of a failure audit events may be dropped.",
      "documentation" :"https://www.cloudera.com/documentation/enterprise/latest/topics/cn_iu_service_audit.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Audit"]
    },
    {
      "id" : 44,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE'] and /Security/deployment/ObjectNode/managementService[type='MGMT']/roles[type='NAVIGATOR']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']//config/items[name='navigator_audit_queue_policy']/value='SHUTDOWN'",
      "level": 3,
      "description": "HBase Audit Drop policy",
      "service" : "HBase",
      "fatal": false,
      "passMessage" : "HBase Audit Drop policy is set to shutdown.",
      "errorMessage": "HBase Audit Drop policy is not to shutdown - in the event of a failure audit events may be dropped.",
      "documentation" :"https://www.cloudera.com/documentation/enterprise/latest/topics/cn_iu_service_audit.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Audit"]
    },
    {
      "id" : 45,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SENTRY'] and /Security/deployment/ObjectNode/managementService[type='MGMT']/roles[type='NAVIGATOR']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SENTRY']//config/items[name='navigator_audit_queue_policy']/value='SHUTDOWN'",
      "level": 3,
      "description": "Sentry Audit Drop policy",
      "service" : "Sentry",
      "fatal": false,
      "passMessage" : "Sentry Audit Drop policy is set to shutdown.",
      "errorMessage": "Sentry Audit Drop policy is not to shutdown - in the event of a failure audit events may be dropped.",
      "documentation" :"https://www.cloudera.com/documentation/enterprise/latest/topics/cn_iu_service_audit.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Audit"]
    },
    {
      "id" : 46,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA'] and /Security/deployment/ObjectNode/managementService[type='MGMT']/roles[type='NAVIGATOR']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']//config/items[name='navigator_audit_queue_policy']/value='SHUTDOWN'",
      "level": 3,
      "description": "Impala Audit Drop policy",
      "service" : "Impala",
      "fatal": false,
      "passMessage" : "Impala Audit Drop policy is set to shutdown.",
      "errorMessage": "Impala Audit Drop policy is not to shutdown - in the event of a failure audit events may be dropped.",
      "documentation" :"https://www.cloudera.com/documentation/enterprise/latest/topics/cn_iu_service_audit.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Audit", "Lineage"]
    },
    {
      "id" : 47,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE'] and /Security/deployment/ObjectNode/managementService[type='MGMT']/roles[type='NAVIGATOR']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE']//config/items[name='navigator_audit_queue_policy']/value='SHUTDOWN'",
      "level": 3,
      "description": "Hive Audit Drop policy",
      "service" : "Hive",
      "fatal": false,
      "passMessage" : "Hive Audit Drop policy is set to shutdown.",
      "errorMessage": "Hive Audit Drop policy is not to shutdown - in the event of a failure audit events may be dropped.",
      "documentation" :"https://www.cloudera.com/documentation/enterprise/latest/topics/cn_iu_service_audit.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Audit", "Lineage"]
    },
    {
      "id" : 48,
      "preConditionXPath": "/Security/deployment/ObjectNode/managementService/roles[type='ACTIVITYMONITOR']",
      "ruleXPath": "/Security/deployment/ObjectNode/managementService/roleConfigGroups[roleType='ACTIVITYMONITOR']//config/items[name='firehose_debug_port'][value='-1']",
      "level": 1,
      "description": "Activity Monitor Web Interface",
      "service" : "Cloudera Management Services",
      "fatal": false,
      "passMessage" : "Activity Monitor Web Interface is disabled.",
      "errorMessage": "Activity Monitor Web Interface will allow access to debug information without authentication.  The interface should be disabled to prevent unauthorized access.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_ig_ports_cm.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Debug Interfaces"]
    },
    {
      "id" : 49,
      "preConditionXPath": "/Security/deployment/ObjectNode/managementService/roles[type='EVENTSERVER']",
      "ruleXPath": "/Security/deployment/ObjectNode/managementService/roleConfigGroups[roleType='EVENTSERVER']//config/items[name='eventserver_debug_port'][value='-1']",
      "level": 1,
      "description": "Event Server Web Interface",
      "service" : "Cloudera Management Services",
      "fatal": false,
      "passMessage" : "Event Server Web Interface is disabled.",
      "errorMessage": "Event Server Web Interface will allow access to debug information without authentication.  The interface should be disabled to prevent unauthorized access.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_ig_ports_cm.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Debug Interfaces"]
    },
    {
      "id" : 50,
      "preConditionXPath": "/Security/deployment/ObjectNode/managementService/roles[type='HOSTMONITOR']",
      "ruleXPath": "/Security/deployment/ObjectNode/managementService/roleConfigGroups[roleType='HOSTMONITOR']//config/items[name='firehose_debug_port'][value='-1']",
      "level": 1,
      "description": "Host Monitor Web Interface",
      "service" : "Cloudera Management Services",
      "fatal": false,
      "passMessage" : "Host Monitor Web Interface is disabled.",
      "errorMessage": "Host Monitor Web Interface will allow access to debug information without authentication.  The interface should be disabled to prevent unauthorized access.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_ig_ports_cm.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Debug Interfaces"]
    },
    {
      "id" : 51,
      "preConditionXPath": "/Security/deployment/ObjectNode/managementService/roles[type='NAVIGATOR'] and /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/managementService/roleConfigGroups[roleType='NAVIGATOR']//config/items[name='navigator_debug_port'][value='-1']",
      "level": 1,
      "description": "Navigator Web Interface",
      "service" : "Cloudera Navigator",
      "fatal": false,
      "passMessage" : "Navigator Web Interface is disabled.",
      "errorMessage": "Navigator Web Interface will allow access to debug information without authentication.  The interface should be disabled to prevent unauthorized access.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_ig_ports_cm.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Debug Interfaces"]
    },
    {
      "id" : 52,
      "preConditionXPath": "/Security/deployment/ObjectNode/managementService/roles[type='REPORTSMANAGER']",
      "ruleXPath": "/Security/deployment/ObjectNode/managementService/roleConfigGroups[roleType='REPORTSMANAGER']//config/items[name='headlamp_debug_port'][value='-1']",
      "level": 1,
      "description": "Reports Manager Web Interface",
      "service" : "Cloudera Management Services",
      "fatal": false,
      "passMessage" : "Reports Manager Web Interface is disabled.",
      "errorMessage": "Reports Manager Web Interface will allow access to debug information without authentication.  The interface should be disabled to prevent unauthorized access.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_ig_ports_cm.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Debug Interfaces"]
    },
    {
      "id" : 53,
      "preConditionXPath": "/Security/deployment/ObjectNode/managementService/roles[type='SERVICEMONITOR']",
      "ruleXPath": "/Security/deployment/ObjectNode/managementService/roleConfigGroups[roleType='SERVICEMONITOR']//config/items[name='firehose_debug_port'][value='-1']",
      "level": 1,
      "description": "Service Monitor Web Interface",
      "service" : "Cloudera Management Services",
      "fatal": false,
      "passMessage" : "Service Monitor Web Interface is disabled.",
      "errorMessage": "Service Monitor Web Interface will allow access to debug information without authentication.  The interface should be disabled to prevent unauthorized access.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_ig_ports_cm.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Debug Interfaces"]
    },
    {
      "id" : 54,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']//items[name='auth_backend']/value = ('desktop.auth.backend.LdapBackend', 'desktop.auth.backend.SpnegoDjangoBackend', 'libsaml.backend.SAML2Backend', 'desktop.auth.backend.OAuthBackend') or /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']//items[name='hue_server_hue_safety_valve' or name='hue_service_safety_valve']/tokenize(tokenize(value,'\\n')[starts-with(.,'backend')],'=')[2][. = ('desktop.auth.backend.LdapBackend', 'desktop.auth.backend.SpnegoDjangoBackend', 'libsaml.backend.SAML2Backend', 'desktop.auth.backend.OAuthBackend')]",
      "level": 1,
      "description": "Hue external authentication",
      "service" : "Hue",
      "fatal": false,
      "passMessage" : "Hue is configured to use external authentication.",
      "errorMessage": "Hue is not configured to use external authentication.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_hue_ldap_config.html",
      "failOnTrue": "false",
      "score": 2,
      "categories" : ["Authentication"]
    },
    {
      "id" : 55,
      "ruleXPath": "/Security/deployment/ObjectNode/managerSettings/items[name='LDAP_USER_GROUPS']/value",
      "level": 1,
      "description": "Cloudera Manager LDAP User Groups",
      "service" : "Cloudera Manager",
      "fatal": false,
      "passMessage" : "Cloudera Manager has LDAP user groups configured",
      "errorMessage": "Cloudera Manager has no LDAP user groups. Any authenticated users will have read-only access to CM.",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_external_auth.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 56,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE']",
      "ruleXPath": "/Security/deployment/ObjectNode/managerSettings/items[name='LDAP_KEY_ADMIN_GROUPS']/value",
      "level": 1,
      "description": "Cloudera Manager Key Admin User Groups",
      "service" : "Cloudera Manager",
      "fatal": false,
      "passMessage" : "Cloudera Manager has a Key Admin User Group configured {0}",
      "errorMessage": "Cloudera Manager has no Key Admin user groups.",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_user_roles.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 57,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']//items[name='extra_auth_to_local_rules']/value!=''",
      "level": 1,
      "description": "Auth to Local Rules",
      "service" : "HDFS",
      "fatal": false,
      "passMessage" : "Additional Auth to Local Rules are configured.",
      "errorMessage": "Additional Auth to Local Rules should be configured to ensure that cluster principals are isolated from other clusters.",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_auth_to_local_isolate.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 58,
      "preConditionXPath": "/Security/deployment/ObjectNode/managementService[type='MGMT']/roles[type='NAVIGATOR'] and /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/managementService/roleConfigGroups[roleType='NAVIGATORMETASERVER']//items[name='ssl_enabled']/value='true'",
      "level": 2,
      "description": "Cloudera Navigator TLS",
      "service" : "Cloudera Navigator",
      "fatal": false,
      "passMessage" : "Cloudera Navigator TLS is enabled.",
      "errorMessage": "Cloudera Navigator TLS is not enabled.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_nav_ssl.html",
      "failOnTrue": "false",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 59,
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SENTRY']",
      "level": 1,
      "description": "Sentry service installed",
      "service" : "Sentry",
      "fatal": false,
      "passMessage" : "Sentry is installed.",
      "errorMessage": "Sentry is not installed.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_sentry_service.html",
      "failOnTrue": "false",
      "score": 5,
      "categories" : ["Authorization"]
    },
    {
      "id" : 60,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE'] and /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SENTRY']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']//items[name='sentry_service'][value=/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SENTRY']/name]",
      "level": 1,
      "description": "Hue Sentry App",
      "service" : "Hue",
      "fatal": false,
      "passMessage" : "Sentry app configured in Hue",
      "errorMessage": "Sentry app not configured in Hue",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_sentry_overview.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 61,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='YARN']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='YARN']//items[name='yarn_admin_acl']/value[text()!='*']",
      "level": 1,
      "description": "YARN Admin ACL default",
      "service" : "YARN",
      "fatal": false,
      "passMessage" : "YARN Admin ACL has been changed from the default * to: '{0}'",
      "errorMessage": "YARN Admin ACL has not been changed from *.  Any user can cancel or affect YARN jobs submitted by other users.",
      "documentation": "https://community.cloudera.com/t5/tkb/articleprintpage/tkb-id/JavaAPI%40tkb/article-id/2" ,
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 62,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE']//items[name='hiveserver2_enable_ssl']/value='true'",
      "level": 2,
      "description": "HiveServer2 TLS",
      "service" : "Hive",
      "fatal": false,
      "passMessage" : "HiveServer2 is configured for TLS encryption.",
      "errorMessage": "HiveServer2 is not configured for TLS encryption.",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_hive_encryption.html",
      "failOnTrue": "false",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 63,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='ZOOKEEPER']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='ZOOKEEPER']//items[name='enableSecurity']/value='true'",
      "level": 1,
      "description": "ZooKeeper Security Enabled",
      "service" : "ZooKeeper",
      "fatal": true,
      "passMessage" : "Zookeeper Security is enabled.",
      "errorMessage": "Zookeeper Security is not enabled",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_zookeeper_security.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authentication"]
    },
    {
      "id" : 64,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KAFKA']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KAFKA']//items[name='kerberos.auth.enable']/value='true'",
      "level": 1,
      "description": "Kafka Kerberos",
      "service" : "Kafka",
      "fatal": true,
      "passMessage" : "Kafka Kerberos Authentication is enabled.",
      "errorMessage": "Kafka Kerberos Authentication is not enabled.",
      "documentation" : "https://www.cloudera.com/documentation/kafka/latest/topics/kafka_security.html",
      "failOnTrue": "false",
      "score": 50,
      "categories" : ["Authentication"]
    },
    {
      "id" : 65,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']//items[name='hbase_security_authentication']/value='kerberos'",
      "level": 1,
      "description": "HBase Kerberos",
      "service" : "HBase",
      "fatal": true,
      "passMessage" : "HBase Kerberos authentication is enabled.",
      "errorMessage": "HBase Kerberos authentication is not enabled.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_hbase_security.html",
      "failOnTrue": "false",
      "score": 50,
      "categories" : ["Authentication"]
    },
    {
      "id" : 66,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KAFKA']",
      "ruleXPath": "not(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KAFKA']//items[name='security.inter.broker.protocol'][not(starts-with(value/text(), 'SASL'))])",
      "level": 2,
      "description": "Kafka Inter-broker Protocol",
      "service" : "Kafka",
      "fatal": false,
      "passMessage" : "Kafka Inter-broker Protocol is correctly set",
      "errorMessage": "Kafka Inter-broker Protocol should be set to inferred, SASL_PLAINTEXT, SASL_SSL.",
      "documentation": "https://www.cloudera.com/documentation/kafka/latest/topics/kafka_security.html",
      "failOnTrue": "false",
      "score": 2,
      "categories" : ["Authentication", "Wire encryption"]
    },
    {
      "id" : 67,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KAFKA']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KAFKA']//items[name='kafka.properties_role_safety_valve'][contains(value/text(),'listeners=')][contains(value/text(),'=PLAINTEXT') or contains(value/text(),',PLAINTEXT')]/value",
      "level": 1,
      "description": "Kafka Plaintext Listeners",
      "service" : "Kafka",
      "fatal": false,
      "passMessage" : "Kafka does not have any unsecured listeners.",
      "errorMessage": "Kafka has the following unsecured listeners: {0}",
      "documentation": "https://www.cloudera.com/documentation/kafka/latest/topics/kafka_security.html",
      "failOnTrue": "true",
      "score": 2,
      "categories" : ["Authentication"]
    },
    {
      "id" : 68,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='OOZIE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='OOZIE']//items[name='oozie_use_ssl']/value/text()='true'",
      "level": 2,
      "description": "Oozie TLS",
      "service" : "Oozie",
      "fatal": false,
      "passMessage" : "Oozie TLS is configured.",
      "errorMessage": "Oozie TLS is not configured.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_ssl_oozie.html",
      "failOnTrue": "false",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 69,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='OOZIE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='OOZIE']//property[name='oozie.service.AuthorizationService.security.enabled']/value/text()='true'",
      "level": 1,
      "description": "Oozie Authorization",
      "service" : "Oozie",
      "fatal": false,
      "passMessage" : "Oozie authorization is configured.",
      "errorMessage": "Oozie authorization is not configured.",
      "documentation" :"https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_oozie_security.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 70,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SOLR']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SOLR']//items[name='solr_use_ssl']/value='true'",
      "level": 2,
      "description": "Solr TLS",
      "service" : "Solr",
      "fatal": false,
      "passMessage" : "Solr is configured to use TLS",
      "errorMessage": "Solr is not configured for TLS (HTTPS)",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_solr_ssl.html",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 71,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']//config/items[name='client_services_ssl_enabled']/value='true'",
      "level": 2,
      "description": "Impala client TLS enabled",
      "service" : "Impala",
      "fatal": false,
      "passMessage" : "Impala is configured with TLS encryption for client connections.",
      "errorMessage": "Impala is not configured with TLS encryption for client connections.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/impala_ssl.html",
      "failOnTrue": "false",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 72,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']",
      "ruleXPath": "count(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']/roleConfigGroups[roleType='CATALOGSERVER']//items[name='webserver_certificate_file'])=1",
      "level": 2,
      "description": "Impala Catalog Server webserver TLS enabled",
      "service" : "Impala",
      "fatal": false,
      "passMessage" : "Impala is configured with TLS encryption for web servers.",
      "errorMessage": "Impala is not configured with TLS encryption for web servers.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/impala_ssl.html",
      "failOnTrue": "false",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 73,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']//items[name='hue_server_hue_safety_valve' or name='hue_service_safety_valve'][contains(replace(value/text(),'\\s',''),'secure=true')]",
      "level": 1,
      "description": "Hue secure cookies",
      "service" : "Hue",
      "fatal": false,
      "passMessage" : "Hue secure cookies are configured.",
      "errorMessage": "Hue secure cookies are not configured.",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authentication"]
    },
    {
      "id" : 74,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']//items[name='hue_server_hue_safety_valve' or name='hue_service_safety_valve'][contains(replace(value/text(),'\\s',''),'ttl=')]",
      "level": 1,
      "description": "Hue secure cookie timeout",
      "service" : "Hue",
      "fatal": false,
      "passMessage" : "Hue secure cookie timeout is configured.",
      "errorMessage": "Hue secure cookie timeout is not configured (defaults to two weeks).",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authentication"]
    },
    {
      "id" : 75,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']//items[name='hue_server_hue_safety_valve' or name='hue_service_safety_valve'][contains(value/text(),'ttl=')]",
      "ruleXPath": "exists(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']//items[name='hue_server_hue_safety_valve' or name='hue_service_safety_valve'][contains(replace(value/text(),'\\s',''),'secure=true')]/value/tokenize(tokenize(text(), '\n')[starts-with(normalize-space(.),'ttl')][last()],'=')[2][number(.)<=86400])",
      "level": 1,
      "description": "Hue secure cookie timeout",
      "service" : "Hue",
      "fatal": false,
      "passMessage" : "Hue secure cookie timeout is configured to one day or less.",
      "errorMessage": "Hue secure cookie timeout is configured to more than one day.",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authentication"]
    },
    {
      "id" : 76,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']//items[name='ssl_cacerts']",
      "level": 2,
      "description": "Hue as a TLS client",
      "service" : "Hue",
      "fatal": false,
      "passMessage" : "Hue is configured as a TLS client.",
      "errorMessage": "Hue is not configured as a TLS client.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_ssl_hue.html",
      "failOnTrue": "false",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 77,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']//items[name/text()='navigator_audit_enabled']/value='false'",
      "level": 3,
      "description": "HBase Audit Collection",
      "service" : "HBase",
      "fatal": false,
      "passMessage" : "HBase Audit Collection is enabled.",
      "errorMessage": "HBase Audit Collection is disabled.",
      "documentation" :"https://www.cloudera.com/documentation/enterprise/latest/topics/cn_iu_service_audit.html",
      "failOnTrue" : true,
      "score": 1,
      "categories" : ["Audit"]
    },
    {
      "id" : 78,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']//items[name/text()='navigator_audit_enabled']/value='false'",
      "level": 3,
      "description": "HDFS Audit Collection",
      "service" : "HDFS",
      "fatal": false,
      "passMessage" : "HDFS Audit Collection is enabled.",
      "errorMessage": "HDFS Audit Collection is disabled.",
      "documentation" :"https://www.cloudera.com/documentation/enterprise/latest/topics/cn_iu_service_audit.html",
      "failOnTrue" : true,
      "score": 1,
      "categories" : ["Audit"]
    },
    {
      "id" : 79,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SENTRY']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SENTRY']//items[name/text()='navigator_audit_enabled']/value='false'",
      "level": 3,
      "description": "Sentry Audit Collection",
      "service" : "Sentry",
      "fatal": false,
      "passMessage" : "Sentry Audit Collection is enabled.",
      "errorMessage": "Sentry Audit Collection is disabled.",
      "documentation" :"https://www.cloudera.com/documentation/enterprise/latest/topics/cn_iu_service_audit.html",
      "failOnTrue" : true,
      "score": 1,
      "categories" : ["Audit"]
    },
    {
      "id" : 80,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE']//items[name/text()='navigator_audit_enabled']/value='false'",
      "level": 3,
      "description": "Hive Audit Collection",
      "service" : "Hive",
      "fatal": false,
      "passMessage" : "Hive Audit Collection is enabled.",
      "errorMessage": "Hive Audit Collection is disabled.",
      "documentation" :"https://www.cloudera.com/documentation/enterprise/latest/topics/cn_iu_service_audit.html",
      "failOnTrue" : true,
      "score": 1,
      "categories" : ["Audit", "Lineage"]
    },
    {
      "id" : 81,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']//items[name/text()='navigator_audit_enabled']/value='false'",
      "level": 3,
      "description": "Hue Audit Collection",
      "service" : "Hue",
      "fatal": false,
      "passMessage" : "Hue Audit Collection is enabled.",
      "errorMessage": "Hue Audit Collection is disabled.",
      "documentation" :"https://www.cloudera.com/documentation/enterprise/latest/topics/cn_iu_service_audit.html",
      "failOnTrue" : true,
      "score": 1,
      "categories" : ["Audit"]
    },
    {
      "id" : 82,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']//items[name/text()='hbase_superuser'][value!='<>']",
      "level": 1,
      "description": "HBase Supergroup",
      "service" : "HBase",
      "fatal": false,
      "passMessage" : "HBase Supergroup is configured.",
      "errorMessage": "HBase Supergroup is not configured.  Grants can only be done from the superuser account.  This is an insecure practice as grants are not attached to a user.",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_hbase_authorization.html",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 83,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']//items[name/text()='hbase_security_authorization']/value='true'",
      "level": 1,
      "description": "HBase Authorization",
      "service" : "HBase",
      "fatal": false,
      "passMessage" : "HBase Authorization is enabled.",
      "errorMessage": "HBase Authorization is not enabled.",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_hbase_authorization.html",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 84,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']//*[name='hbase.security.exec.permission.checks']/value='true'",
      "level": 1,
      "description": "HBase Endpoint Coprocessor Authorization",
      "service" : "HBase",
      "fatal": false,
      "passMessage" : "HBase Endpoint Coprocessor Authorization is enabled.",
      "errorMessage": "HBase Endpoint Coprocessor Authorization is disabled.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/admin_hbase_security.html",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 85,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HBASE']//items[name='hbase_rpc_protection']/value='privacy'",
      "level": 2,
      "description": "HBase Transport Encryption",
      "service" : "HBase",
      "fatal": false,
      "passMessage" : "HBase Transport Encryption is enabled.",
      "errorMessage": "HBase Transport Encryption is disabled.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_hbase_encrypt_transport.html",
      "score": 1,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 86,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']//items[name='hadoop_secure_web_ui']/value='true'",
      "level": 1,
      "description": "HDFS Web UI Kerberos authentication",
      "service" : "HDFS",
      "fatal": false,
      "passMessage" : "HDFS Web UI Kerberos authentication is enabled.",
      "errorMessage": "HDFS Web UI Kerberos authentication is disabled.",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_web_auth.html#xd_583c10bfdbd326ba--69adf108-1492ec0ce48--7c12",
      "score": 1,
      "categories" : ["Authentication"]
    },
    {
      "id" : 87,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='YARN']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='YARN']//items[name='hadoop_secure_web_ui']/value='true'",
      "level": 1,
      "description": "YARN Web UI Kerberos authentication",
      "service" : "YARN",
      "fatal": false,
      "passMessage" : "YARN Web UI Kerberos authentication is enabled.",
      "errorMessage": "YARN Web UI Kerberos authentication is disabled.",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_web_auth.html#xd_583c10bfdbd326ba--69adf108-1492ec0ce48--7c12",
      "score": 1,
      "categories" : ["Authentication"]
    },
    {
      "id" : 88,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']//items[name='dfs_umaskmode']/value[number(substring(text(),string-length(text())))<6] or not(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']//items[name='dfs_umaskmode'])",
      "level": 2,
      "description": "HDFS Umask",
      "service" : "HDFS",
      "fatal": false,
      "passMessage" : "HDFS Umask does not permit world-readable permissions.",
      "errorMessage": "HDFS Umask permits world-readable permissions.",
      "failOnTrue": "true",
      "score": 3,
      "categories" : ["Authorization"]
    },
    {
      "id" : 89,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters/services[type='KEYTRUSTEE_SERVER']",
      "ruleXPath": "count(/Security/deployment/ObjectNode/clusters/services[type='KEYTRUSTEE_SERVER']/roles)=4",
      "level": 3,
      "description": "Key Trustee Server High Availability",
      "service" : "KTS",
      "fatal": false,
      "passMessage" : "Key Trustee is in HA configuration.",
      "errorMessage": "Key Trustee is not in HA configuration.",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/key_trustee_initialize_ha.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Encryption at rest", "High Availability"]
    },
    {
      "id" : 90,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']//config/items[name='kms_service'][value=/Security/deployment/ObjectNode/clusters/services[type='KEYTRUSTEE']/name]",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters/services[type='KEYTRUSTEE_SERVER']",
      "level": 2,
      "description": "Key Trustee Server",
      "service" : "KTS",
      "fatal": false,
      "passMessage" : "Key Trustee Server is configured.",
      "errorMessage": "Key Trustee Server is not configured.",
      "documentation":"https://www.cloudera.com/documentation/enterprise/latest/topics/sg_key_trustee.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Encryption at rest"]
    },
    {
      "id" : 91,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE']/roles[type='HIVESERVER2'] and not(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE']/roleConfigGroups[roleType='HIVESERVER2']//items[name='hiveserver2_webui_port']/value='0')",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE']/roleConfigGroups[roleType='HIVESERVER2']/config/items[name='ssl_enabled']/value='true'",
      "level": 2,
      "description": "HiveServer2 Web UI TLS",
      "service" : "Hive",
      "fatal": false,
      "passMessage" : "HiveServer2 Web UI TLS is enabled.",
      "errorMessage": "HiveServer2 Web UI TLS is disabled.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_mc_hive_webui.html",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 92,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE']//items[name='ssl_enabled']/value='true'",
      "level": 2,
      "description": "KMS TLS",
      "service" : "KMS",
      "fatal": false,
      "passMessage" : "KMS TLS is enabled.",
      "errorMessage": "KMS TLS is disabled.",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/5-7-x/topics/cdh_sg_kms_security.html#concept_nkz_22v_mp",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 93,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KS_INDEXER']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KS_INDEXER']//items[name='hbase_indexer_security_authentication']/value='kerberos'",
      "level": 1,
      "description": "KeyValue Indexer Authentication",
      "service" : "KeyValue Store Indexer",
      "fatal": false,
      "passMessage" : "KeyValue Indexer Kerberos authentication is enabled.",
      "errorMessage": "KeyValue Indexer Kerberos authentication is disabled.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/search_config_hbase_indexer_for_search.html",
      "score": 1,
      "categories" : ["Authentication"]
    },
    {
      "_comment" : "Reference TSB2016-175, TSB2017-174 (Impala only), 2017-252 (Impala and Kudu only)",
      "id" : 94,
      "ruleXPath": "(/Security/deployment/ObjectNode/clusters[name=$clusterName][parcels/product='CDH']/fullVersion[number(tokenize(text(),'\\.')[1])=6 or (number(tokenize(text(),'\\.')[1])=5 and (number(tokenize(text(),'\\.')[2])>=9 or (number(tokenize(text(),'\\.')[2])=8 and number(tokenize(text(),'\\.')[3])>=2) or (number(tokenize(text(),'\\.')[2])=7 and number(tokenize(text(),'\\.')[3])>=3) or (not(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']) and ((number(tokenize(text(),'\\.')[2])=5 and number(tokenize(text(),'\\.')[3])>=5) or (number(tokenize(text(),'\\.')[2])=4 and number(tokenize(text(),'\\.')[3])>=11)))))]) and  not(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KUDU'] and /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA'] and /Security/deployment/ObjectNode/clusters[name=$clusterName]/fullVersion=('5.10.0','5.10.2','5.10.3','5.11.0','5.11.1','5.12.0'))",
      "level": 1,
      "description": "CDH CVE Check",
      "service" : "General",
      "fatal": false,
      "passMessage" : "This version of CDH {1} has no known high-severity CVEs.",
      "errorMessage": "This version of CDH {1} has one or more known high-severity CVEs.  All CVEs are communicated through Technical Service Bulletins, which are emailed to support contacts as well as included in the Cloudera Support Knowledge base, and the Cloudera Community.",
      "documentation": "https://community.cloudera.com/t5/Technical-Service-Bulletins/bd-p/TSB",
      "score": 20,
      "categories" : ["Vulnerabilities"],
      "outputXPaths" : ["/Security/deployment/ObjectNode/clusters[name=$clusterName][parcels/product='CDH']/fullVersion"]
    },
    {
      "_comment" : "Reference TSB2017-235",
      "id" : 95,
      "ruleXPath": "/Security/deployment/ObjectNode/versionInfo/version[number(tokenize(text(),'\\.')[1])=6 or (number(tokenize(text(),'\\.')[1])=5 and (number(tokenize(text(),'\\.')[2])>=12 or (number(tokenize(text(),'\\.')[2])=11 and number(tokenize(text(),'\\.')[3])>=1) or (number(tokenize(text(),'\\.')[2])=10 and number(tokenize(text(),'\\.')[3])>=2) or (number(tokenize(text(),'\\.')[2])=9 and number(tokenize(text(),'\\.')[3])>=3)))]",
      "level": 1,
      "description": "CM CVE Check",
      "service" : "Cloudera Manager",
      "fatal": false,
      "passMessage" : "This version of CM {1} has no known high-severity CVEs.",
      "errorMessage": "This version of CM {1} has one or more known high-severity CVEs.  All CVEs are communicated through Technical Service Bulletins, which are emailed to support contacts as well as included in the Cloudera Support Knowledge base and the Cloudera Community",
      "documentation": "https://community.cloudera.com/t5/Technical-Service-Bulletins/bd-p/TSB",
      "score": 20,
      "categories" : ["Vulnerabilities"],
      "outputXPaths" : ["/Security/deployment/ObjectNode/versionInfo/version"]
    },
    {
      "id" : 96,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK_ON_YARN']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK_ON_YARN']/roleConfigGroups[roleType='GATEWAY']//items[name='spark_io_encryption_enabled']/value='true' or (/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK_ON_YARN']/roleConfigGroups[roleType='GATEWAY']//items[name='spark-conf/spark-defaults.conf_client_config_safety_valve']/value/tokenize(tokenize(text(),'\\n')[starts-with(.,'spark.shuffle.encryption.enabled')], '=')[normalize-space(.) = 'true'])",
      "level": 2,
      "description": "Spark Encrypted Shuffle",
      "service" : "Spark",
      "fatal": false,
      "passMessage" : "Spark Encrypted Shuffle is enabled.",
      "errorMessage": "Spark Encrypted Shuffle is disabled.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_spark_encryption.html",
      "score": 1,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 97,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK_ON_YARN']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK_ON_YARN']/roleConfigGroups[roleType='GATEWAY']//items[name='spark-conf/spark-defaults.conf_client_config_safety_valve']/value/tokenize(tokenize(text(),'\\n')[starts-with(.,'spark.network.sasl.serverAlwaysEncrypt')], '=')[normalize-space(.) = 'true'] and (/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK_ON_YARN']/roleConfigGroups[roleType='GATEWAY']//items[name='spark_network_encryption_enabled']/value='true' or /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK_ON_YARN']/roleConfigGroups[roleType='GATEWAY']//items[name='spark-conf/spark-defaults.conf_client_config_safety_valve']/value/tokenize(tokenize(text(),'\\n')[starts-with(.,'spark.authenticate.enableSaslEncryption')], '=')[normalize-space(.) = 'true'])",
      "level": 2,
      "description": "SASL Encryption for Spark RPCs",
      "service" : "Spark",
      "fatal": false,
      "passMessage" : "SASL Encryption for Spark RPCs is enabled.",
      "errorMessage": "SASL Encryption for Spark RPCs is disabled.",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_spark_encryption.html#concept_fmz_xv1_3v",
      "score": 1,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 98,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK_ON_YARN']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK_ON_YARN']//items[name='spark_authenticate']/value='true'",
      "level": 1,
      "description": "Spark Authentication with a Shared Secret",
      "service" : "Spark",
      "fatal": false,
      "passMessage" : "Spark Authentication with a Shared Secret is enabled.",
      "errorMessage": "Spark Authentication with a Shared Secret is disabled.",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_spark_auth.html#concept_vwz_gjj_zt",
      "score": 1,
      "categories" : ["Authentication"]
    },
    {
      "id" : 99,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK2_ON_YARN']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK2_ON_YARN']/roleConfigGroups[roleType='GATEWAY']//items[name='spark2-conf/spark-defaults.conf_client_config_safety_valve']/value/tokenize(tokenize(text(),'\\n')[starts-with(.,'spark.io.encryption.enabled')], '=')[normalize-space(.) = 'true']",
      "level": 2,
      "description": "Spark2 Encrypted Shuffle",
      "service" : "Spark2",
      "fatal": false,
      "passMessage" : "Spark2 Encrypted Shuffle is enabled.",
      "errorMessage": "Spark2 Encrypted Shuffle is disabled.",
      "score": 1,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 100,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK2_ON_YARN']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK2_ON_YARN']/roleConfigGroups[roleType='GATEWAY']//items[name='spark2-conf/spark-defaults.conf_client_config_safety_valve']/value/tokenize(tokenize(text(),'\\n')[starts-with(.,'spark.network.sasl.serverAlwaysEncrypt')], '=')[normalize-space(.) = 'true'] and /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK2_ON_YARN']/roleConfigGroups[roleType='GATEWAY']//items[name='spark2-conf/spark-defaults.conf_client_config_safety_valve']/value/tokenize(tokenize(text(),'\\n')[starts-with(.,'spark.authenticate.enableSaslEncryption')], '=')[normalize-space(.) = 'true']",
      "level": 2,
      "description": "SASL Encryption for Spark2 RPCs",
      "service" : "Spark2",
      "fatal": false,
      "passMessage" : "SASL Encryption for Spark2 RPCs is enabled.",
      "errorMessage": "SASL Encryption for Spark2 RPCs is disabled.",
      "score": 1,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 101,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK2_ON_YARN']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK2_ON_YARN']//items[name='spark_authenticate']/value='true'",
      "level": 1,
      "description": "Spark2 Authentication with a Shared Secret",
      "service" : "Spark2",
      "fatal": false,
      "passMessage" : "Spark2 Authentication with a Shared Secret is enabled.",
      "errorMessage": "Spark2 Authentication with a Shared Secret is disabled.",
      "score": 1,
      "categories" : ["Authentication"]
    },
    {
      "id" : 102,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='YARN']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='YARN']//*[name='mapreduce.shuffle.ssl.enabled']/value='true' or /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']/config/items[name/text()='hdfs_hadoop_ssl_enabled']/value='true'",
      "level": 2,
      "description": "YARN Encrypted Shuffle",
      "service" : "YARN",
      "fatal": false,
      "passMessage" : "YARN Encrypted Shuffle is enabled.",
      "errorMessage": "YARN Encrypted Shuffle is disabled.",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_encryption_enable.html",
      "score": 1,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 104,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='YARN']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='YARN']//*[name='mapreduce.job.encrypted-intermediate-data']/value='true'",
      "level": 2,
      "description": "MapReduce Encrypted Spills",
      "service" : "YARN",
      "fatal": false,
      "passMessage" : "MapReduce Encrypted Spills are enabled.",
      "errorMessage": "MapReduce Encrypted Spills are disabled.  Data written to disk during map, reduce and shuffle stages will be written unencrypted.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_spill_encryption.html",
      "score": 1,
      "categories" : ["Ephemeral on-disk encryption"]
    },
    {
      "id" : 105,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE'] and /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE']/roleConfigGroups[roleType='KMS_KEYTRUSTEE']//items[name='kms-acls.xml_role_safety_valve']/value//property[name='hadoop.kms.blacklist.CREATE']/value!='REDACTED'",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE']/roleConfigGroups[roleType='KMS_KEYTRUSTEE']//items[name='kms-acls.xml_role_safety_valve']/value//property[name='hadoop.kms.blacklist.CREATE']/value[tokenize(tokenize(text(), ' ')[1],',')=(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']/config/items[name='kerberos_princ_name']/value/string(),'hdfs')[1]][tokenize(tokenize(text(), ' ')[2],',')=(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']/config/items[name='dfs_permissions_supergroup']/value/string(),'supergroup')[1]]",
      "level": 2,
      "description": "KMS ACL restricts CREATE operation",
      "service" : "KMS",
      "fatal": false,
      "passMessage" : "KMS ACL blacklists the privileged users and groups from running CREATE operations.",
      "errorMessage": "KMS ACL does not blacklist dfs.permissions.superusergroup user (default: hdfs) and the dfs.cluster.administrators group (default: supergroup) from running CREATE operations.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_kms_security.html#concept_fgf_42v_mp",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Encryption at rest", "Authorization"]
    },
    {
      "id" : 106,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE'] and /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE']/roleConfigGroups[roleType='KMS_KEYTRUSTEE']//items[name='kms-acls.xml_role_safety_valve']/value//property[name='hadoop.kms.blacklist.DELETE']/value!='REDACTED'",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE']/roleConfigGroups[roleType='KMS_KEYTRUSTEE']//items[name='kms-acls.xml_role_safety_valve']/value//property[name='hadoop.kms.blacklist.DELETE']/value[tokenize(tokenize(text(), ' ')[1],',')=(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']/config/items[name='kerberos_princ_name']/value/string(),'hdfs')[1]][tokenize(tokenize(text(), ' ')[2],',')=(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']/config/items[name='dfs_permissions_supergroup']/value/string(),'supergroup')[1]]",
      "level": 2,
      "description": "KMS ACL restricts DELETE operation",
      "service" : "KMS",
      "fatal": false,
      "passMessage" : "KMS ACL privileged users and groups from running DELETE operations.",
      "errorMessage": "KMS ACL does not blacklist dfs.permissions.superusergroup user (default: hdfs) and the dfs.cluster.administrators group (default: supergroup) from running DELETE operations.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_kms_security.html#concept_fgf_42v_mp",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Encryption at rest", "Authorization"]
    },
    {
      "id" : 107,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE'] and /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE']/roleConfigGroups[roleType='KMS_KEYTRUSTEE']//items[name='kms-acls.xml_role_safety_valve']/value//property[name='hadoop.kms.blacklist.ROLLOVER']/value!='REDACTED'",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE']/roleConfigGroups[roleType='KMS_KEYTRUSTEE']//items[name='kms-acls.xml_role_safety_valve']/value//property[name='hadoop.kms.blacklist.ROLLOVER']/value[tokenize(tokenize(text(), ' ')[1],',')=(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']/config/items[name='kerberos_princ_name']/value/string(),'hdfs')[1]][tokenize(tokenize(text(), ' ')[2],',')=(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']/config/items[name='dfs_permissions_supergroup']/value/string(),'supergroup')[1]]",
      "level": 2,
      "description": "KMS ACL restricts ROLLOVER operation",
      "service" : "KMS",
      "fatal": false,
      "passMessage" : "KMS ACL privileged users and groups from running ROLLOVER operations.",
      "errorMessage": "KMS ACL does not blacklist dfs.permissions.superusergroup user (default: hdfs) and the dfs.cluster.administrators group (default: supergroup) from running ROLLOVER operations.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_kms_security.html#concept_fgf_42v_mp",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Encryption at rest", "Authorization"]
    },
    {
      "id" : 108,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE'] and /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE']/roleConfigGroups[roleType='KMS_KEYTRUSTEE']//items[name='kms-acls.xml_role_safety_valve']/value//property[name='hadoop.kms.blacklist.DECRYPT_EEK']/value!='REDACTED'",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE']/roleConfigGroups[roleType='KMS_KEYTRUSTEE']//items[name='kms-acls.xml_role_safety_valve']/value//property[name='hadoop.kms.blacklist.DECRYPT_EEK']/value[tokenize(tokenize(text(), ' ')[1],',')=(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']/config/items[name='kerberos_princ_name']/value/string(),'hdfs')[1]][tokenize(tokenize(text(), ' ')[2],',')=(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']/config/items[name='dfs_permissions_supergroup']/value/string(),'supergroup')[1]]",
      "level": 2,
      "description": "KMS ACL restricts DECRYPT_EEK operation",
      "service" : "KMS",
      "fatal": false,
      "passMessage" : "KMS ACL privileged users and groups from running DECRYPT_EEK operations.",
      "errorMessage": "KMS ACL does not blacklist dfs.permissions.superusergroup user (default: hdfs) and the dfs.cluster.administrators group (default: supergroup) from running DECRYPT_EEK operations.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_kms_security.html#concept_fgf_42v_mp",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Encryption at rest", "Authorization"]
    },
    {
      "id" : 109,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE'] and /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE']/roleConfigGroups[roleType='KMS_KEYTRUSTEE']//items[name='kms-acls.xml_role_safety_valve']/value//property[name='hadoop.kms.blacklist.GET']/value!='REDACTED'",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KEYTRUSTEE']/roleConfigGroups[roleType='KMS_KEYTRUSTEE']//items[name='kms-acls.xml_role_safety_valve']/value//property[name='hadoop.kms.blacklist.GET']/value='*'",
      "level": 2,
      "description": "KMS ACL restricts GET operation",
      "service" : "KMS",
      "fatal": false,
      "passMessage" : "KMS ACL blacklists everyone from running GET operations.",
      "errorMessage": "KMS ACL does not blacklist everyone from running GET operations.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_kms_security.html#concept_fgf_42v_mp",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Encryption at rest", "Authorization"]
    },
    {
      "id" : 110,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE']",
      "ruleXPath": "(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE']//items[name='hive_proxy_user_groups_list']/value/string(),'*')[1]='*' and (/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']//items[name='hive_proxy_user_groups_list']/value/string(),'*')[1]='*'",
      "level": 2,
      "description": "Hive Proxy User Groups List ACL",
      "service" : "Hive",
      "fatal": false,
      "passMessage" : "Proxy User Groups ACL defined. Only users in ACL groups can access hive metastore.",
      "errorMessage": "Proxy User Groups ACL not defined. All users can access Hive metastore.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_sentry_overview.html",
      "failOnTrue": "true",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 111,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KUDU']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KUDU']//items[name='enable_security']/value='true'",
      "level": 1,
      "description": "Kudu Secure Authentication and Encryption",
      "service" : "Kudu",
      "fatal": false,
      "passMessage" : "Secure authentication and encryption between all Kudu clients and servers as well as between individual servers is enabled",
      "errorMessage": "Secure authentication and encryption is disabled",
      "documentation": "https://www.cloudera.com/documentation/kudu/latest/topics/kudu_security.html",
      "failOnTrue": "false",
      "categories" : ["Authentication", "Wire encryption"],
      "score": 1
    },
    {
      "id" : 112,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KUDU']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KUDU']/roleConfigGroups[roleType='KUDU_MASTER']//items[name='ssl_enabled']/value='true'",
      "level": 2,
      "description": "Kudu Master Server TLS",
      "service" : "Kudu",
      "fatal": false,
      "passMessage" : "Communication between Kudu clients and master servers is encrypted using Transport Layer Security (TLS)",
      "errorMessage": "Communication between Kudu clients and master servers is not encrypted",
      "documentation": "https://www.cloudera.com/documentation/kudu/latest/topics/kudu_security.html",
      "failOnTrue": "false",
      "categories" : ["Wire encryption"],
      "score": 2
    },
    {
      "id" : 113,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KUDU']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='KUDU']/roleConfigGroups[roleType='KUDU_TSERVER']//items[name='ssl_enabled']/value='true'",
      "level": 2,
      "description": "Kudu Tablet Server TLS",
      "service" : "Kudu",
      "fatal": false,
      "passMessage" : "Communication between Kudu clients and tablet servers is encrypted using Transport Layer Security (TLS)",
      "errorMessage": "Communication between Kudu clients and tablet servers is not encrypted",
      "documentation": "https://www.cloudera.com/documentation/kudu/latest/topics/kudu_security.html",
      "failOnTrue": "false",
      "categories" : ["Wire encryption"],
      "score": 2
    },
    {
      "id" : 114,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='ZOOKEEPER']//items[name='zk_server_java_opts']/value[contains(text(), 'zookeeper.DigestAuthenticationProvider.superDigest')]",
      "ruleXPath": "true()",
      "level": 1,
      "description": "ZooKeeper Super Digest",
      "service" : "ZooKeeper",
      "fatal": false,
      "passMessage" : "",
      "errorMessage": "Enables an administrator to access the znode hierarchy as a superuser and bypass ACL checks. This setting can be useful for short periods of maintenance or debugging but should not be left in place permanently as it is a security hole.",
      "failOnTrue": "true",
      "score": 10,
      "categories" : ["Authorization"]
    },
    {
      "id" : 115,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='ZOOKEEPER']//items[name='zk_server_java_opts']/value[contains(text(), 'zookeeper.skipACL=yes')]",
      "ruleXPath": "true()",
      "level": 1,
      "description": "ZooKeeper ACL Checks Disabled",
      "service" : "ZooKeeper",
      "fatal": false,
      "passMessage" : "",
      "errorMessage": "The zookeeper.skipACL system parameter is set. This effectively disables all ACL checking, allowing full access to the ZooKeeper tree to all users. This setting can be useful for short periods of maintenance or debugging but should not be left in place permanently as it is a security hole.",
      "failOnTrue": "true",
      "score": 20,
      "categories" : ["Authorization"]
    },
    {
      "id" : 116,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']",
      "ruleXPath": "count(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']/roleConfigGroups[roleType='IMPALAD']//items[name='webserver_htpassword_password'])=1",
      "level": 1,
      "description": "Impala Daemon web server authentication enabled",
      "service" : "Impala",
      "fatal": false,
      "passMessage" : "Impala Daemon web server is configured for password authentication.",
      "errorMessage": "Impala Daemon web server is not configured for password authentication.",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authentication"]
    },
    {
      "id" : 117,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']",
      "ruleXPath": "count(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']/roleConfigGroups[roleType='CATALOGSERVER']//items[name='webserver_htpassword_password'])=1",
      "level": 1,
      "description": "Impala Daemon web server authentication enabled",
      "service" : "Impala",
      "fatal": false,
      "passMessage" : "Impala Catalog Server web server is configured for password authentication.",
      "errorMessage": "Impala Catalog Server web server is not configured for password authentication.",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authentication"]
    },
    {
      "id" : 118,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']",
      "ruleXPath": "count(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']/roleConfigGroups[roleType='STATESTORE']//items[name='webserver_htpassword_password'])=1",
      "level": 1,
      "description": "Impala Statestore web server authentication enabled",
      "service" : "Impala",
      "fatal": false,
      "passMessage" : "Impala Statestore web server is configured for password authentication.",
      "errorMessage": "Impala Statestore web server is not configured for password authentication.",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authentication"]
    },
    {
      "id" : 119,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']",
      "ruleXPath": "count(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']/roleConfigGroups[roleType='IMPALAD']//items[name='webserver_certificate_file'])=1",
      "level": 2,
      "description": "Impala Daemon webserver TLS enabled",
      "service" : "Impala",
      "fatal": false,
      "passMessage" : "Impala Daemon is configured with TLS encryption for web servers.",
      "errorMessage": "Impala Daemon is not configured with TLS encryption for web servers.",
      "failOnTrue": "false",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 120,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']",
      "ruleXPath": "count(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']/roleConfigGroups[roleType='STATESTORE']//items[name='webserver_certificate_file'])=1",
      "level": 2,
      "description": "Impala Statestore webserver TLS enabled",
      "service" : "Impala",
      "fatal": false,
      "passMessage" : "Impala Statestore is configured with TLS encryption for web servers.",
      "errorMessage": "Impala Statestore is not configured with TLS encryption for web servers.",
      "failOnTrue": "false",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 121,
      "preConditionXPath" : "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']/config/items[name='ldap_url']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']//config/items/value[starts-with(text(),'ldaps://')] or not(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']/config/items[name='use_start_tls']/value='false')",
      "level": 2,
      "description": "Hue LDAPS is preferred to LDAP",
      "service" : "Hue",
      "fatal": false,
      "passMessage" : "Hue is configured to use LDAPS.",
      "errorMessage": "Hue is not configured to use LDAPS. Authentication requests, including passwords can be observed on the network for these services.",
      "failOnTrue": "false",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_hue_ldap_config.html#concept_czy_fpq_3n",
      "score": 2,
      "categories" : ["Wire encryption", "Authorization"]
    },
    {
      "id" : 122,
      "preConditionXPath" : "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SOLR']//config/items[name='solr_enable_ldap_auth']/value='true'",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SOLR']//config/items[name='solr_ldap_uri']/value[starts-with(text(),'ldaps://')] or /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SOLR']/config/items[name='solr_ldap_enable_starttls']/value='true'",
      "level": 2,
      "description": "Solr LDAPS is preferred to LDAP",
      "service" : "Solr",
      "fatal": false,
      "passMessage" : "Solr is configured to use LDAPS.",
      "errorMessage": "Solr is not configured to use LDAPS. Authentication requests, including passwords can be observed on the network for these services.",
      "failOnTrue": "false",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_search_security.html#concept_mqd_ns1_kt",
      "score": 2,
      "categories" : ["Wire encryption", "Authorization"]
    },
    {
      "id" : 123,
      "preConditionXPath" : "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']//config/items[name='enable_ldap_auth']/value='true'",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']//config/items[name='impala_ldap_uri']/value[starts-with(text(),'ldaps://')] or /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='IMPALA']/config/items[name='enable_ldap_tls']/value='true'",
      "level": 2,
      "description": "Impala LDAPS is preferred to LDAP",
      "service" : "Impala",
      "fatal": false,
      "passMessage" : "Impala is configured to use LDAPS.",
      "errorMessage": "Impala is not configured to use LDAPS. Authentication requests, including passwords can be observed on the network for these services.",
      "failOnTrue": "false",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/impala_ldap.html#ldap_security",
      "score": 2,
      "categories" : ["Wire encryption", "Authorization"]
    },
    {
      "id" : 124,
      "preConditionXPath" : "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']//config/items[name='hadoop_security_group_mapping']/value='org.apache.hadoop.security.LdapGroupsMapping'",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']//config/items[name='hadoop_group_mapping_ldap_url']/value[starts-with(text(),'ldaps://')] or /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']/config/items[name='hadoop_group_mapping_ldap_use_ssl']/value='true'",
      "level": 2,
      "description": "HDFS LDAPS is preferred to LDAP",
      "service" : "HDFS",
      "fatal": false,
      "passMessage" : "HDFS is configured to use LDAPS. Note: Cloudera strongly recommends against using Hadoop's LdapGroupsMapping provider.",
      "errorMessage": "HDFS is not configured to use LDAPS. Authentication requests, including passwords can be observed on the network for these services. Note: Cloudera strongly recommends against using Hadoop's LdapGroupsMapping provider.",
      "failOnTrue": "false",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_ldap_grp_mappings.html#xd_583c10bfdbd326ba--6eed2fb8-14349d04bee--7bc3",
      "score": 2,
      "categories" : ["Wire encryption", "Authorization"]
    },
    {
      "id" : 125,
      "preConditionXPath" : "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE']//config/items[name='hiveserver2_enable_ldap_auth']/value='true'",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HIVE']//config/items[name='hiveserver2_ldap_uri']/value[starts-with(text(),'ldaps://')]",
      "level": 2,
      "description": "HiveServer2 LDAPS is preferred to LDAP",
      "service" : "Hive",
      "fatal": false,
      "passMessage" : "HiveServer2 is configured to use LDAPS.",
      "errorMessage": "HiveServer2 is not configured to use LDAPS. Authentication requests, including passwords can be observed on the network for these services.",
      "failOnTrue": "false",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_sg_hiveserver2_security.html#concept_byf_k4p_dn",
      "score": 2,
      "categories" : ["Wire encryption", "Authorization"]
    },
    {
      "id" : 126,
      "preConditionXPath" : "/Security/deployment/ObjectNode/managementService/roleConfigGroups[roleType='NAVIGATORMETASERVER']/config/items[name='nav_ldap_url']/value[starts-with(text(),'ldap')]",
      "ruleXPath": "/Security/deployment/ObjectNode/managementService/roleConfigGroups[roleType='NAVIGATORMETASERVER']/config/items[name='nav_ldap_url']/value[starts-with(text(),'ldaps://')]",
      "level": 2,
      "description": "Cloudera Navigator LDAPS is preferred to LDAP",
      "service" : "Cloudera Navigator",
      "fatal": false,
      "passMessage" : "Cloudera Navigator is configured to use LDAPS.",
      "errorMessage": "Cloudera Navigator is not configured to use LDAPS. Authentication requests, including passwords can be observed on the network for these services.",
      "failOnTrue": "false",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/cn_sg_external_auth.html#cmug_topic_13_9_2__section_orm_dcb_pp",
      "score": 2,
      "categories" : ["Wire encryption", "Authorization"]
    },
    {
      "id" : 127,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE'] and not(/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']/config/items[name='create_users_on_login']/value='false')",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HUE']//items[name='hue_server_hue_safety_valve' or name='hue_service_safety_valve']/value/tokenize(tokenize(text(), '\n')[starts-with(normalize-space(.),'home_dir_permissions')][last()],'=')[2][number(substring(.,4,1))<=1]",
      "level": 1,
      "description": "Hue home directory creation permissions",
      "service" : "Hue",
      "fatal": false,
      "passMessage" : "Hue is creating home directories yet are set to not permit world-readable permissions: {0}",
      "errorMessage": "Hue is creating home directories with world-readable permissions.",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authorization"]
    },
    {
      "id" : 128,
      "preConditionXPath": "/Security/deployment/ObjectNode/managementService[type='MGMT']/roles[type='NAVIGATOR'] and /Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='HDFS']",
      "ruleXPath": "/Security/deployment/ObjectNode/managementService/roleConfigGroups[roleType='NAVIGATOR']//items[name='ssl_enabled']/value='true'",
      "level": 3,
      "description": "Cloudera Navigator Audit TLS",
      "service" : "Cloudera Navigator",
      "fatal": false,
      "passMessage" : "Cloudera Navigator Audit TLS is enabled.",
      "errorMessage": "Cloudera Navigator Audit TLS is not enabled.",
      "documentation": "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_nav_tls_nas.html",
      "failOnTrue": "false",
      "score": 2,
      "categories" : ["Wire encryption", "Audit"]
    },
    {
      "id" : 129,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters/services[type='SENTRY']",
      "ruleXPath": "count(/Security/deployment/ObjectNode/clusters/services[type='SENTRY']/roles[type='SENTRY_SERVER'])=2",
      "level": 1,
      "description": "Sentry Server High Availability",
      "service" : "Sentry",
      "fatal": false,
      "passMessage" : "Sentry is in HA configuration.",
      "errorMessage": "Sentry is not in HA configuration.",
      "documentation" : "https://www.cloudera.com/documentation/enterprise/latest/topics/sg_sentry_ha.html",
      "failOnTrue": "false",
      "score": 1,
      "categories" : ["Authorization", "High Availability"]
    },
    {
      "id" : 130,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK_ON_YARN']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK_ON_YARN']/roleConfigGroups[roleType='SPARK_YARN_HISTORY_SERVER']/config/items[name='ssl_enabled']/value='true'",
      "level": 2,
      "description": "Spark JobHistoryServer TLS",
      "service" : "Spark",
      "fatal": false,
      "passMessage" : "Spark Job History Server TLS is enabled.",
      "errorMessage": "Spark Job History Server TLS is disabled.",
      "score": 2,
      "categories" : ["Wire encryption"]
    },
    {
      "id" : 131,
      "preConditionXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK2_ON_YARN']",
      "ruleXPath": "/Security/deployment/ObjectNode/clusters[name=$clusterName]/services[type='SPARK2_ON_YARN']/roleConfigGroups[roleType='SPARK2_YARN_HISTORY_SERVER']/config/items[name='ssl_enabled']/value='true'",
      "level": 2,
      "description": "Spark2 Job History Server TLS",
      "service" : "Spark2",
      "fatal": false,
      "passMessage" : "Spark2 Job History Server TLS is enabled.",
      "errorMessage": "Spark2 Job History Server TLS is disabled.",
      "score": 2,
      "categories" : ["Wire encryption"]
    }
  ]
}
